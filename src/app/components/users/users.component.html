<div *ngIf="users">
  <div class="flex justify-content-between mb-2 gap-2 md:flex-row flex-column">
    <div class="flex gap-2">
      <h2 class="text-4xl">Usuarios</h2>
      <app-new-user *ngIf="isAdmin"></app-new-user>
    </div>
    <div class="flex gap-2 flex-wrap md:flex-nowrap">
      <span class="p-input-icon-left w-full" styleClass="w-full">
        <i class="pi pi-search"></i>
        <p-autoComplete
          styleClass="w-full"
          class="w-full"
          [(ngModel)]="searchQuery"
          [suggestions]="filteredSuggestions"
          (completeMethod)="searchUserSuggestions($event)"
          field="name"
          placeholder="Buscar por nombre"
          (onSelect)="filterUsersBySelected($event)"
        ></p-autoComplete>
      </span>
      <p-button
        *ngIf="!mobile"
        (click)="cleanFilters()"
        icon="pi pi-eraser"
      ></p-button>
    </div>
  </div>
  <p-table
    [value]="filteredUsers"
    [paginator]="true"
    [rows]="5"
    [tableStyle]="{ 'margin-bottom': '20px' }"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} posteos"
    [showFirstLastIcon]="!mobile"
  >
    <ng-template pTemplate="header">
      <tr>
        <th class="text-xl" *ngIf="!mobile">ID</th>
        <th class="text-xl" *ngIf="!mobile">Nombre</th>
        <th class="text-xl">Usuario</th>
        <th class="text-xl flex gap-2 justify-content-center">Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
      <tr>
        <td *ngIf="!mobile">{{ user.id }}</td>
        <td class="capitalize font-medium" *ngIf="!mobile">{{ user.name }}</td>
        <td>{{ user.username }}</td>
        <td class="text-xl flex gap-2 justify-content-center">
          <app-view-user [user]="user" [users]="users"></app-view-user>
          <app-edit-user [user]="user" *ngIf="isAdmin"></app-edit-user>
          <div *ngIf="isAdmin">
            <p-button
              (click)="deleteUser($event, user.id)"
              icon="pi pi-fw pi-trash"
            ></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
